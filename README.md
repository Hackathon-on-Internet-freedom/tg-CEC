# "tg-ЦИК" для сбора статистики о чём угодно

> Легко и сладостно говорить правду в лицо королю

# Что это такое и с чем его едят?

Пишем описание данных в json, выполняем пару команд и получаем бота для
периодического получения альтернативных данных и сайт, на котором видна
суммарная статистика для анализа.

- [Презентация на хакатоне ОЗИ - 7 июня 2020 г.](/docs/tg-cec-demo.pdf)

Любой также может подключиться к хранению и анализу, и чем больше людей это
делают, тем сложнее заблокировать сайт или манипулировать результатами - для
хранения используются децентрализованные решения.

Ещё о формате данных:
- каждого участника можно просить сообщить свой регион - тогда в суммарной
статистике будет разбиение по географии; 
- сохраняется время отправки - можно видеть динамику;
- данные можно только дополнять - поэтому все исправления видны;
- участники могут отправлять данные открыто, под псевдонимами или
  конфиденциально - на усмотрение организатора сбора;
- организатор сбора может построить сеть доверия источникам, но при этом
  отправлять данные всё ещё могут все.

## Как это можно использовать?

- Представьте "Белый счётчик", который не просто раз в три часа публикует,
  сколько людей на митинге, а складывает данные в децентрализованную сеть - и
  все желающие могут наблюдать в реальном времени, сколько человек пришли не
  просто в разных городах, но и даже через разные проходы.
- Представьте активистов с самодельными станциями мониторинга воздуха, которые
  выкладывают результаты каждый час на общую карту.
- Представьте медработников, которые могут одним сообщением отправить статистику
  о свободных койках и новых случаях внебольничной пневмонии - давая возможность
  отслеживать эту информацию всем желающим.
- Представьте наблюдателей на выборах, которые нажатием одной кнопки (например,
  [такой](https://www.aliexpress.com/item/32973667926.html)) фиксируют время
  прихода голосующих на часы раньше официальной статистики, или проводят
  экзит-поллы, отправляя информацию в проверяемом виде.

## В проект нужны:

- Любой, кто хочет и может помочь идеями использования, анализа, дизайна и чем угодно ещё

## Контакты:
Мансур
* gltronred@gmail.com	
* https://t.me/gltronred
* https://github.com/gltronred

# Более технические детали

## Требования к формату данных

Чтобы набор данных было интереснее анализировать, имеет смысл сохранять: 

- географию поступающих сообщений - например, при первой отправке данных
  запрашивая регион, город и т.д. (детализация и геоструктура настраивается
  создателем бота)
- время поступления сообщения (возможно, загрублённо). Для проверяемости того,
  что сообщение поступило не раньше определённого времени можно использовать
  timestamping authority, либо централизованный, либо привязку к блокчейну.
  Имеет смысл указывать также последнее известное отправителю сообщение

## Структуры

Чтобы весь этот набор данных можно было обрабатывать, данные должны быть структурированы.

- Геоструктура образует дерево. Населённые пункты входят в регионы, регионы в
  страны и т.п. В каждом узле графа для агрегации нужно выполнять какую-то
  операцию (например, максимум или минимум - для разных источников на одном
  участке, сумму - для разных участков в одном городе). Уровни и операции
  фиксированы и задаются в конфигурационном файле.
- Доверие - орграф общего вида с выделенным истоком.
- Каждое сообщение подписывается и содержит хэш предыдущего
  сообщения, чтобы обеспечить линейную историю.
  
## Итого

Бот работает по сценарию вопросов и записывает результаты в гуглотаблицу. 

Если периодически получать данные из гуглотаблицы, можно будет проверить, что
данные только добавлялись.

Допустимые типы собираемых данных:

- время (собирается автоматически)
- id пользователя (автоматически; можно сохранять открыто, анонимно (хэш) или конфиденциально (в зашифрованном виде))
- город (автоматически, ближайший в [файле](/example-geo.csv) к отправленной локации)
- целое число
- вещественное число
- текст
- текст в зашифрованном виде (например, для открытия результатов после завершения работа бота)
- хэш предыдущего сообщения (автоматически; сейчас в таблицу пишет один
  источник, консенсуса нод не требуется; для IPFS или SSB будет отдельно
  собираться список источников)
- подпись строки (собираем csv-строку с разделителями-запятыми и без
  экранирования из всего, что выше, подписываем; нужно будет улучшить формат,
  сейчас возможно использовать запятые в тексте)

Криптография:

- хэш (для авторства и цепочки сообщений): SHA-256
- подпись (каждой строки): Ed25519
- шифр (для авторства и зашифрованных строк): ChaCha-Poly1305

Документация:

- Формат файла конфигурации описан в [коде](/bot/src/CEC/Types.hs) и в примерах (файлы `example-configN.json`). Документация будет.
- Формат файла результатов будет задокументирован.
- Скрипт для подготовки и проверки файла конфигурации не готов.
- Скрипт проверки файла результатов (проверка подписей и цепочки хэшей) не готов.

